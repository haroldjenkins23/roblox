--======================================================================--
--  ESP with MENU KEYBIND & UI (v35 - The Final, Polished Version)
--======================================================================--

--// Step 1: Define the settings table that our UI will control
local Settings = {
    -- Core Visuals
    ESP_Enabled = true, Team_Check = true, Show_Teammates = true,
    Name_Enabled = true, Distance_Enabled = true,
    ESP_Render_Distance = 500,
    Enemy_Color = Color3.fromRGB(255, 50, 50),
    Teammate_Color = Color3.fromRGB(50, 150, 255),
    -- Aimbot Features
    Aimbot_Enabled = false,
    Aim_at_Head = true,
    Show_FOV = true,
    FOV_Size = 80,
    Smoothing = 10
}

--// ====================================================================
--//  CUSTOM UI CREATION
--// ====================================================================

local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")

local CustomUIScreenGui = Instance.new("ScreenGui", CoreGui); CustomUIScreenGui.Name = "CustomESP_UI_Container"; CustomUIScreenGui.ResetOnSpawn = false
local MainWindow = Instance.new("Frame", CustomUIScreenGui); MainWindow.Size = UDim2.fromOffset(450, 530); MainWindow.Position = UDim2.fromOffset(20, 20); MainWindow.BackgroundColor3 = Color3.fromRGB(35, 35, 35); MainWindow.BorderSizePixel = 0
MainWindow.Visible = false -- Start with the menu hidden

local TitleBar = Instance.new("Frame", MainWindow); TitleBar.Size = UDim2.new(1, 0, 0, 30); TitleBar.BackgroundColor3 = Color3.fromRGB(25, 25, 25); TitleBar.BorderSizePixel = 0
local TitleLabel = Instance.new("TextLabel", TitleBar); TitleLabel.Size = UDim2.new(1,-10,1,0); TitleLabel.Position = UDim2.fromOffset(5,0); TitleLabel.BackgroundTransparency = 1; TitleLabel.Text = "Project ESP - v35"; TitleLabel.Font = Enum.Font.SourceSansBold; TitleLabel.TextColor3 = Color3.fromRGB(255,255,255); TitleLabel.TextXAlignment = Enum.TextXAlignment.Left; TitleLabel.TextSize = 16
local dragging, dragStart, startPos; TitleBar.InputBegan:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then dragging=true;dragStart=i.Position;startPos=MainWindow.Position;i.Changed:Connect(function()if i.UserInputState==Enum.UserInputState.End then dragging=false end end)end end); UserInputService.InputChanged:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseMovement and dragging then local d=i.Position-dragStart;MainWindow.Position=UDim2.new(startPos.X.Scale,startPos.X.Offset+d.X,startPos.Y.Scale,startPos.Y.Offset+d.Y)end end)
local TabContainer = Instance.new("Frame", MainWindow); TabContainer.Size = UDim2.new(1,0,0,30); TabContainer.Position = UDim2.new(0,0,0,30); TabContainer.BackgroundColor3 = Color3.fromRGB(45,45,45); TabContainer.BorderSizePixel = 0
local TabListLayout = Instance.new("UIListLayout", TabContainer); TabListLayout.FillDirection = Enum.FillDirection.Horizontal; TabListLayout.Padding = UDim.new(0, 5)
local ContentContainer = Instance.new("Frame", MainWindow); ContentContainer.Size = UDim2.new(1,-20,1,-80); ContentContainer.Position = UDim2.new(0,10,0,70); ContentContainer.BackgroundTransparency = 1
local VisualsPage = Instance.new("Frame", ContentContainer); VisualsPage.Size = UDim2.fromScale(1,1); VisualsPage.BackgroundTransparency = 1; local VisualsListLayout = Instance.new("UIListLayout", VisualsPage); VisualsListLayout.Padding = UDim.new(0, 10)
local AimPage = Instance.new("Frame", ContentContainer); AimPage.Size = UDim2.fromScale(1,1); AimPage.BackgroundTransparency = 1; AimPage.Visible = false; local AimListLayout = Instance.new("UIListLayout", AimPage); AimListLayout.Padding = UDim.new(0, 10)
local ActiveTabColor, InactiveTabColor = Color3.fromRGB(60,60,60), Color3.fromRGB(45,45,45)
local VisualsTabButton = Instance.new("TextButton", TabContainer); VisualsTabButton.Size = UDim2.fromOffset(100, 30); VisualsTabButton.BackgroundColor3 = ActiveTabColor; VisualsTabButton.Text = "VISUALS"; VisualsTabButton.Font = Enum.Font.SourceSansBold; VisualsTabButton.TextColor3 = Color3.fromRGB(255,255,255); VisualsTabButton.TextSize = 14
local AimTabButton = Instance.new("TextButton", TabContainer); AimTabButton.Size = UDim2.fromOffset(100, 30); AimTabButton.BackgroundColor3 = InactiveTabColor; AimTabButton.Text = "AIM"; AimTabButton.Font = Enum.Font.SourceSansBold; AimTabButton.TextColor3 = Color3.fromRGB(255,255,255); AimTabButton.TextSize = 14
VisualsTabButton.MouseButton1Click:Connect(function() VisualsPage.Visible = true; AimPage.Visible = false; VisualsTabButton.BackgroundColor3 = ActiveTabColor; AimTabButton.BackgroundColor3 = InactiveTabColor end)
AimTabButton.MouseButton1Click:Connect(function() VisualsPage.Visible = false; AimPage.Visible = true; VisualsTabButton.BackgroundColor3 = InactiveTabColor; AimTabButton.BackgroundColor3 = ActiveTabColor end)
local function createToggle(parent, name, defaultValue, callback) local frame = Instance.new("Frame", parent); frame.Size = UDim2.new(1,0,0,25); frame.BackgroundTransparency = 1; local label = Instance.new("TextLabel", frame); label.Size=UDim2.new(0.5,0,1,0); label.BackgroundTransparency=1; label.Font=Enum.Font.SourceSans; label.Text=name; label.TextColor3=Color3.fromRGB(255,255,255); label.TextXAlignment=Enum.TextXAlignment.Left; label.TextSize=16; local button = Instance.new("TextButton", frame); button.Size=UDim2.fromOffset(50,20); button.Position=UDim2.new(1,-50,0.5,-10); button.BackgroundColor3=Color3.fromRGB(80,80,80); button.Text=""; local indicator = Instance.new("Frame", button); indicator.Size=UDim2.fromOffset(16,16); indicator.BackgroundColor3=Color3.fromRGB(200,200,200); local value = defaultValue; local function updateVisuals() indicator.Position = value and UDim2.new(1,-18,0.5,-8) or UDim2.new(0,2,0.5,-8) end; button.MouseButton1Click:Connect(function() value=not value;updateVisuals();if callback then callback(value) end end); updateVisuals() end
local function createRGBSliders(parent, name, defaultColor, callback) local frame = Instance.new("Frame", parent); frame.Size=UDim2.new(1,0,0,60); frame.BackgroundTransparency=1; local label = Instance.new("TextLabel", frame); label.Size=UDim2.new(0.5,0,0,20); label.BackgroundTransparency=1; label.Font=Enum.Font.SourceSans; label.Text=name; label.TextColor3=Color3.fromRGB(255,255,255); label.TextXAlignment=Enum.TextXAlignment.Left; label.TextSize=16; local colorPreview = Instance.new("Frame", frame); colorPreview.Size=UDim2.fromOffset(20,20); colorPreview.Position=UDim2.new(1,-20,0,0); colorPreview.BackgroundColor3=defaultColor; local r,g,b=defaultColor.r*255,defaultColor.g*255,defaultColor.b*255; local function fireCallback() local nC=Color3.fromRGB(r,g,b); colorPreview.BackgroundColor3=nC; if callback then callback(nC) end end; local function createSlider(yPos, colorName) local sliderFrame = Instance.new("Frame", frame); sliderFrame.Size=UDim2.new(1,-30,0,10); sliderFrame.Position=UDim2.fromOffset(0,yPos); sliderFrame.BackgroundColor3=Color3.fromRGB(80,80,80); local indicator = Instance.new("Frame", sliderFrame); indicator.Size=UDim2.fromOffset(8,14); indicator.Position=UDim2.new(0,-4,0.5,-7); indicator.BackgroundColor3=Color3.fromRGB(200,200,200); local isDragging=false; local function update(input) if isDragging or input.UserInputType==Enum.UserInputType.MouseButton1 then local x=math.clamp(input.Position.X-sliderFrame.AbsolutePosition.X,0,sliderFrame.AbsoluteSize.X); local percent=x/sliderFrame.AbsoluteSize.X; if colorName=="R" then r=math.floor(percent*255) end; if colorName=="G" then g=math.floor(percent*255) end; if colorName=="B" then b=math.floor(percent*255) end; indicator.Position=UDim2.new(percent,-4,0.5,-7); fireCallback() end end; sliderFrame.InputBegan:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then isDragging=true; update(i) end end); sliderFrame.InputEnded:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then isDragging=false end end); sliderFrame.InputChanged:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseMovement then update(i) end end); return indicator end; local rI,gI,bI=createSlider(25,"R"),createSlider(40,"G"),createSlider(55,"B"); rI.Position=UDim2.new(r/255,-4,0.5,-7); gI.Position=UDim2.new(g/255,-4,0.5,-7); bI.Position=UDim2.new(b/255,-4,0.5,-7) end
local function createSlider(parent, name, min, max, defaultValue, callback) local frame = Instance.new("Frame", parent); frame.Size=UDim2.new(1,0,0,30); frame.BackgroundTransparency=1; local label = Instance.new("TextLabel", frame); label.Size=UDim2.new(0.5,0,1,0); label.BackgroundTransparency=1; label.Font=Enum.Font.SourceSans; label.Text=name; label.TextColor3=Color3.fromRGB(255,255,255); label.TextXAlignment=Enum.TextXAlignment.Left; label.TextSize=16; local valueLabel = Instance.new("TextLabel", frame); valueLabel.Size=UDim2.new(0.5,0,1,0); valueLabel.Position=UDim2.new(0.5,0,0,0); valueLabel.BackgroundTransparency=1; valueLabel.Font=Enum.Font.SourceSans; valueLabel.TextColor3=Color3.fromRGB(200,200,200); valueLabel.TextXAlignment=Enum.TextXAlignment.Right; valueLabel.TextSize=16; local sliderFrame = Instance.new("Frame", frame); sliderFrame.Size=UDim2.new(1,-10,0,10); sliderFrame.Position=UDim2.new(0,5,1,-15); sliderFrame.BackgroundColor3=Color3.fromRGB(80,80,80); local indicator = Instance.new("Frame", sliderFrame); indicator.Size=UDim2.fromOffset(8,14); indicator.Position=UDim2.new(0,-4,0.5,-7); indicator.BackgroundColor3=Color3.fromRGB(200,200,200); local isDragging=false; local function update(input) if isDragging or input.UserInputType==Enum.UserInputType.MouseButton1 then local x=math.clamp(input.Position.X-sliderFrame.AbsolutePosition.X,0,sliderFrame.AbsoluteSize.X); local percent=x/sliderFrame.AbsoluteSize.X; local value=math.floor(min+(max-min)*percent); valueLabel.Text=tostring(value); indicator.Position=UDim2.new(percent,-4,0.5,-7); if callback then callback(value) end end end; sliderFrame.InputBegan:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then isDragging=true; update(i) end end); sliderFrame.InputEnded:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then isDragging=false end end); sliderFrame.InputChanged:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseMovement then update(i) end end); local initialPercent=(defaultValue-min)/(max-min); indicator.Position=UDim2.new(initialPercent,-4,0.5,-7); valueLabel.Text=tostring(defaultValue) end
createToggle(VisualsPage,"Enable ESP",Settings.ESP_Enabled,function(v)Settings.ESP_Enabled=v end);createToggle(VisualsPage,"Show Name",Settings.Name_Enabled,function(v)Settings.Name_Enabled=v end);createToggle(VisualsPage,"Show Distance",Settings.Distance_Enabled,function(v)Settings.Distance_Enabled=v end);createToggle(VisualsPage,"Team Check",Settings.Team_Check,function(v)Settings.Team_Check=v end);createToggle(VisualsPage,"Show Teammates",Settings.Show_Teammates,function(v)Settings.Show_Teammates=v end);createSlider(VisualsPage, "Render Distance", 50, 2000, Settings.ESP_Render_Distance, function(v) Settings.ESP_Render_Distance = v end);createRGBSliders(VisualsPage,"Enemy Color",Settings.Enemy_Color,function(v)Settings.Enemy_Color=v end);createRGBSliders(VisualsPage,"Teammate Color",Settings.Teammate_Color,function(v)Settings.Teammate_Color=v end)
createToggle(AimPage,"Enable Aimbot",Settings.Aimbot_Enabled,function(v)Settings.Aimbot_Enabled=v end);createToggle(AimPage,"Aim at Head",Settings.Aim_at_Head,function(v)Settings.Aim_at_Head=v end);createToggle(AimPage,"Show FOV Circle",Settings.Show_FOV,function(v)Settings.Show_FOV=v end);createSlider(AimPage,"FOV Size",20,300,Settings.FOV_Size,function(v)Settings.FOV_Size=v end);createSlider(AimPage,"Smoothing",1,20,Settings.Smoothing,function(v)Settings.Smoothing=v end);local aimKeyLabel=Instance.new("TextLabel",AimPage);aimKeyLabel.Size=UDim2.new(1,0,0,20);aimKeyLabel.BackgroundTransparency=1;aimKeyLabel.Font=Enum.Font.SourceSans;aimKeyLabel.Text="Aimbot Key: Hold Right Mouse Button";aimKeyLabel.TextColor3=Color3.fromRGB(200,200,200);aimKeyLabel.TextSize=14

--// === NEW: KEYBIND LOGIC ===
UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if gameProcessedEvent then return end -- Ignore if typing in chat
    if input.KeyCode == Enum.KeyCode.Insert then
        MainWindow.Visible = not MainWindow.Visible
    end
end)

--// ====================================================================
--//  ESP & AIMBOT SCRIPT CORE
--// ====================================================================

local Players = game:GetService("Players"); local RunService = game:GetService("RunService"); local LocalPlayer = Players.LocalPlayer
local CORNER_SCALE = 0.25; local THICKNESS = 2; local SIZING_CONSTANT = 0.5 
local espGui = Instance.new("ScreenGui", CoreGui); espGui.Name = "ESP_Drawing_Container"; espGui.ResetOnSpawn = false
local camera = workspace.CurrentCamera
local FOVCircle = Instance.new("Frame", CustomUIScreenGui); FOVCircle.BackgroundTransparency = 1; FOVCircle.BorderSizePixel = 1; FOVCircle.BorderColor3 = Color3.fromRGB(255,255,255); FOVCircle.ZIndex = 999; local UICorner = Instance.new("UICorner", FOVCircle); UICorner.CornerRadius = UDim.new(1, 0)
local raycastParams = RaycastParams.new(); raycastParams.FilterType = Enum.RaycastFilterType.Exclude

function createPlayerESP()
	local container = Instance.new("Frame", espGui); container.BackgroundTransparency=1; container.Size=UDim2.fromOffset(0,0)
	local elements = {Container=container,Corners={},NameLabel=Instance.new("TextLabel",container),DistanceLabel=Instance.new("TextLabel",container)}
	for i=1,4 do local h=Instance.new("Frame",container);h.BorderSizePixel=0;local v=Instance.new("Frame",container);v.BorderSizePixel=0;table.insert(elements.Corners,h);table.insert(elements.Corners,v) end
	elements.NameLabel.TextSize=14;elements.NameLabel.Font=Enum.Font.SourceSansBold;elements.NameLabel.TextStrokeTransparency=0.4;elements.NameLabel.BackgroundTransparency=1;elements.NameLabel.TextXAlignment=Enum.TextXAlignment.Center;elements.NameLabel.AnchorPoint=Vector2.new(0.5,1)
	elements.DistanceLabel.TextSize=12;elements.DistanceLabel.Font=Enum.Font.SourceSans;elements.DistanceLabel.TextStrokeTransparency=0.4;elements.DistanceLabel.BackgroundTransparency=1;elements.DistanceLabel.TextXAlignment=Enum.TextXAlignment.Center;elements.DistanceLabel.AnchorPoint=Vector2.new(0.5,0)
	return elements
end

local activeESPs = {}
local crosshairPosition = Vector2.new(camera.ViewportSize.X / 2, camera.ViewportSize.Y / 2)

RunService.RenderStepped:Connect(function()
	if not camera then camera = workspace.CurrentCamera; return end
    crosshairPosition = Vector2.new(camera.ViewportSize.X / 2, camera.ViewportSize.Y / 2); raycastParams.FilterDescendantsInstances = {LocalPlayer.Character, camera}
    local aimTarget = nil
    if Settings.Aimbot_Enabled and UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton2) then
        local closestPlayer, minDistance = nil, Settings.FOV_Size
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                local isTeammate = Settings.Team_Check and LocalPlayer.Team and player.Team and player.Team == LocalPlayer.Team
                if not isTeammate then
                    local character = player.Character; local aimPartName = Settings.Aim_at_Head and "Head" or "HumanoidRootPart"; local aimPart = character and character:FindFirstChild(aimPartName); local rootPart = character and character:FindFirstChild("HumanoidRootPart")
                    if aimPart and rootPart then
                        local raycastResult = workspace:Raycast(camera.CFrame.Position, (aimPart.Position - camera.CFrame.Position), raycastParams)
                        if not raycastResult or raycastResult.Instance:IsDescendantOf(character) then
                            local screenPos, onScreen = camera:WorldToScreenPoint(rootPart.Position)
                            if onScreen then
                                local distanceToCrosshair = (Vector2.new(screenPos.X, screenPos.Y) - crosshairPosition).Magnitude
                                if distanceToCrosshair < minDistance then minDistance = distanceToCrosshair; closestPlayer = player end
                            end
                        end
                    end
                end
            end
        end
        aimTarget = closestPlayer
    end
    if aimTarget then
        local aimPartName = Settings.Aim_at_Head and "Head" or "HumanoidRootPart"; local aimPart = aimTarget.Character and aimTarget.Character:FindFirstChild(aimPartName)
        if aimPart then local newCFrame = CFrame.lookAt(camera.CFrame.Position, aimPart.Position); camera.CFrame = camera.CFrame:Lerp(newCFrame, 1 - (Settings.Smoothing / 20)) end
    end
    FOVCircle.Visible = Settings.Show_FOV; if Settings.Show_FOV then FOVCircle.Size = UDim2.fromOffset(Settings.FOV_Size * 2, Settings.FOV_Size * 2); FOVCircle.Position = UDim2.fromOffset(crosshairPosition.X - Settings.FOV_Size, crosshairPosition.Y - Settings.FOV_Size) end
    if not Settings.ESP_Enabled then if #activeESPs > 0 then for _, esp in pairs(activeESPs) do esp.Container.Visible=false end end; return end
	local playersThisFrame = {}
	for _, player in ipairs(Players:GetPlayers()) do
		if player ~= LocalPlayer then
			local character = player.Character; local humanoid = character and character:FindFirstChildOfClass("Humanoid"); local rootPart = character and character:FindFirstChild("HumanoidRootPart")
			if humanoid and rootPart and humanoid.Health > 0 then
				table.insert(playersThisFrame, player)
				local isTeammate = false; if Settings.Team_Check and LocalPlayer.Team and player.Team and player.Team == LocalPlayer.Team then isTeammate = true end
				if isTeammate and not Settings.Show_Teammates then if activeESPs[player] then activeESPs[player].Container.Visible = false end; continue end
				local esp = activeESPs[player] or createPlayerESP(); activeESPs[player] = esp; local viewportPoint = camera:WorldToViewportPoint(rootPart.Position)
                local distance = math.floor((camera.CFrame.Position - rootPart.Position).Magnitude)
				if viewportPoint.Z > 0 and distance <= Settings.ESP_Render_Distance then
					esp.Container.Visible = true
					local depth=viewportPoint.Z;local boxHeight=math.clamp(camera.ViewportSize.Y/(depth*SIZING_CONSTANT),20,1000);local boxWidth=boxHeight*0.6
					local cframe, size=character:GetBoundingBox();local screenPos=camera:WorldToScreenPoint(cframe.Position);local boxTopLeft=Vector2.new(screenPos.X-boxWidth/2,screenPos.Y-boxHeight/2)
					esp.Container.Position=UDim2.fromOffset(boxTopLeft.X,boxTopLeft.Y);esp.Container.Size=UDim2.fromOffset(boxWidth,boxHeight)
					local currentColor=isTeammate and Settings.Teammate_Color or Settings.Enemy_Color
					for _,corner in ipairs(esp.Corners) do corner.BackgroundColor3=currentColor end
                    local h_size=UDim2.new(CORNER_SCALE,0,0,THICKNESS);local v_size=UDim2.new(0,THICKNESS,CORNER_SCALE,0)
					esp.Corners[1].Size=h_size;esp.Corners[1].Position=UDim2.fromScale(0,0);esp.Corners[2].Size=v_size;esp.Corners[2].Position=UDim2.fromScale(0,0); esp.Corners[3].Size=h_size;esp.Corners[3].Position=UDim2.new(1-CORNER_SCALE,0,0,0);esp.Corners[4].Size=v_size;esp.Corners[4].Position=UDim2.new(1,-THICKNESS,0,0); esp.Corners[5].Size=h_size;esp.Corners[5].Position=UDim2.new(0,0,1,-THICKNESS);esp.Corners[6].Size=v_size;esp.Corners[6].Position=UDim2.new(0,0,1-CORNER_SCALE,0); esp.Corners[7].Size=h_size;esp.Corners[7].Position=UDim2.new(1-CORNER_SCALE,0,1,-THICKNESS);esp.Corners[8].Size=v_size;esp.Corners[8].Position=UDim2.new(1,-THICKNESS,1-CORNER_SCALE,0)
                    esp.NameLabel.Visible = Settings.Name_Enabled; if Settings.Name_Enabled then esp.NameLabel.TextColor3 = currentColor; esp.NameLabel.Text=player.Name; esp.NameLabel.Position=UDim2.new(0.5,0,0,-4); esp.NameLabel.Size=UDim2.new(1.5,0,0,14) end
                    esp.DistanceLabel.Visible = Settings.Distance_Enabled; if Settings.Distance_Enabled then esp.DistanceLabel.TextColor3 = currentColor; esp.DistanceLabel.Text="["..distance.."s]";esp.DistanceLabel.Position=UDim2.new(0.5,0,1,4);esp.DistanceLabel.Size=UDim2.new(1.5,0,0,12) end
				else
					esp.Container.Visible=false
				end
			else
				if activeESPs[player] then activeESPs[player].Container.Visible=false end
			end
		end
	end
	for player, esp in pairs(activeESPs) do if not table.find(playersThisFrame, player) then esp.Container:Destroy();activeESPs[player]=nil end end
end)
print("Project ESP with Menu Keybind (v35) Initialized. Press 'Insert' to toggle the menu.")
